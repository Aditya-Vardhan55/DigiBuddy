<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DigiBuddy - Your Digital Literacy Companion</title>
    <style>
        :root {
            --primary-color: #7c3aed; /* Vibrant purple */
            --secondary-color: #10b981; /* Kept vibrant green for contrast */
            --accent-color: #ec4899; /* Bright pink */
            --light-color: #f9fafb; /* Light gray */
            --dark-color: #1f2937; /* Darker gray */
            --gray-color: #6b7280; /* Medium gray */
            --font-large: 1.6rem;
            --font-medium: 1.3rem;
            --font-normal: 1rem;
            --border-radius: 16px;
            --shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease-in-out;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #e9d5ff, #a5b4fc, #f9a8d4); /* New purple-blue-pink gradient */
            color: var(--dark-color);
            line-height: 1.7;
            transition: var(--transition);
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 24px;
        }

        header {
            text-align: center;
            padding: 32px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 32px;
            transform: translateY(0);
            transition: transform 0.4s ease, box-shadow 0.4s ease;
        }

        header:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.8rem;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .tagline {
            color: var(--gray-color);
            font-size: var(--font-medium);
            font-weight: 500;
        }

        .chat-container {
            display: flex;
            gap: 24px;
            margin-top: 24px;
            height: 75vh;
        }

        .sidebar {
            flex: 1;
            background: white;
            border-radius: var(--border-radius);
            padding: 24px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            gap: 16px;
            max-width: 320px;
            transition: var(--transition);
        }

        .sidebar:hover {
            transform: translateY(-2px);
        }

        .main-button {
            padding: 16px;
            font-size: var(--font-medium);
            background: var(--light-color);
            color: var(--dark-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .main-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .main-button:hover::before {
            left: 100%;
        }

        .main-button:hover {
            background: var(--primary-color);
            color: white;
            transform: scale(1.02);
        }

        .main-button i {
            font-size: var(--font-large);
            transition: var(--transition);
        }

        .chat-box {
            flex: 3;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: var(--transition);
        }

        .chat-box:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
        }

        .chat-header {
            background: linear-gradient(90deg, var(--primary-color), #c084fc); /* Purple to light purple gradient */
            color: white;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .bot-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .bot-avatar {
            width: 48px;
            height: 48px;
            background: var(--light-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            font-weight: 700;
            font-size: var(--font-medium);
            transition: var(--transition);
        }

        .bot-name {
            font-size: var(--font-medium);
            font-weight: 600;
        }

        .chat-accessibility {
            display: flex;
            gap: 12px;
        }

        .accessibility-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: var(--font-medium);
            opacity: 0.8;
            transition: var(--transition);
        }

        .accessibility-btn:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .chat-messages {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
            background: #fafafa;
        }

        .message {
            max-width: 85%;
            padding: 16px;
            border-radius: var(--border-radius);
            font-size: var(--font-normal);
            animation: slideIn 0.4s ease;
            transition: var(--transition);
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .bot-message {
            background: var(--light-color);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }

        .user-message {
            background: var(--primary-color);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .tutorial-message {
            background: var(--light-color);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
            border-left: 4px solid var(--secondary-color);
            width: 100%;
        }

        .tutorial-message h3 {
            color: var(--secondary-color);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .tutorial-message ol {
            margin-left: 24px;
            margin-top: 12px;
        }

        .tutorial-message li {
            margin-bottom: 10px;
        }

        .tutorial-message .tutorial-tips {
            background: rgba(16, 185, 129, 0.1);
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
            font-size: 0.95rem;
        }

        .chat-input-container {
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-top: 1px solid #e5e7eb;
            background: white;
        }

        .chat-input {
            flex: 1;
            padding: 16px;
            border: 1px solid #d1d5db;
            border-radius: 9999px;
            font-size: var(--font-normal);
            outline: none;
            transition: var(--transition);
        }

        .chat-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2);
        }

        .send-btn, .voice-btn {
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .send-btn {
            background: var(--primary-color);
            color: white;
        }

        .send-btn:hover {
            background: #6d28d9;
            transform: scale(1.05);
        }

        .voice-btn {
            background: var(--accent-color);
            color: white;
        }

        .voice-btn:hover {
            background: #db2777;
            transform: scale(1.05);
        }

        .quick-replies {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 12px;
        }

        .quick-reply-btn {
            background: var(--light-color);
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            border-radius: 9999px;
            padding: 10px 18px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .quick-reply-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 12px 16px;
            background: var(--light-color);
            border-radius: 9999px;
            width: fit-content;
            align-self: flex-start;
            margin-bottom: 12px;
        }

        .typing-dot {
            width: 10px;
            height: 10px;
            background: var(--gray-color);
            border-radius: 50%;
            animation: typingAnimation 1.2s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-6px); }
        }

        .hidden {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .accessibility-panel {
            background: white;
            padding: 24px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 24px;
            animation: slideDown 0.4s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .accessibility-panel h2 {
            margin-bottom: 16px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .accessibility-options {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
        }

        .accessibility-option {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .language-selector {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            font-size: var(--font-normal);
            transition: var(--transition);
        }

        .language-selector:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2);
        }

        .font-size-controls {
            display: flex;
            gap: 12px;
        }

        .font-btn {
            background: var(--light-color);
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 8px 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .font-btn:hover {
            background: #e5e7eb;
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .chat-container {
                flex-direction: column;
                height: auto;
            }

            .sidebar {
                max-width: 100%;
                flex-direction: row;
                flex-wrap: wrap;
                overflow-x: auto;
                gap: 12px;
            }

            .main-button {
                flex: 1;
                min-width: 140px;
                padding: 12px;
                font-size: var(--font-normal);
            }

            .chat-box {
                height: 70vh;
            }
        }

        body.large-font {
            --font-large: 2.2rem;
            --font-medium: 1.9rem;
            --font-normal: 1.6rem;
        }

        body.high-contrast {
            --primary-color: #000;
            --secondary-color: #000;
            --accent-color: #000;
            --light-color: #fff;
            --dark-color: #000;
            --gray-color: #333;
            --shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        body.high-contrast .bot-message {
            background: #eee;
            border: 2px solid #000;
        }

        body.high-contrast .user-message {
            background: #333;
            color: #fff;
            border: 2px solid #fff;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeInModal 0.3s ease;
        }

        @keyframes fadeInModal {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            padding: 32px;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 600px;
            max-height: 85vh;
            overflow-y: auto;
            transform: scale(0.95);
            animation: modalPop 0.3s ease forwards;
        }

        @keyframes modalPop {
            to { transform: scale(1); }
        }

        .close-modal {
            float: right;
            font-size: 1.8rem;
            cursor: pointer;
            background: none;
            border: none;
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--primary-color);
            transform: rotate(90deg);
        }

        .modal-title {
            color: var(--primary-color);
            margin-bottom: 24px;
            font-weight: 600;
        }

        .chatbot-docs h3 {
            margin: 16px 0 12px;
            font-weight: 600;
        }

        .chatbot-docs ul {
            margin-left: 24px;
            margin-bottom: 16px;
        }

        .chatbot-docs p {
            margin-bottom: 12px;
        }

        .feature-icon {
            font-size: 28px;
            margin-right: 8px;
            color: var(--primary-color);
        }

        .motivation-banner {
            background: rgba(236, 72, 153, 0.1); /* Updated to match accent color */
            border-left: 4px solid var(--accent-color);
            padding: 14px 16px;
            margin: 16px 0;
            border-radius: 8px;
            font-style: italic;
            animation: slideIn 0.4s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>DigiBuddy</h1>
            <p class="tagline">Your friendly guide to the digital world</p>
        </header>

        <div id="accessibilityPanel" class="accessibility-panel hidden">
            <h2>Accessibility Options</h2>
            <div class="accessibility-options">
                <div class="accessibility-option">
                    <label for="language">Language:</label>
                    <select id="language" class="language-selector">
                        <option value="en">English</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="hi">Hindi</option>
                    </select>
                </div>
                <div class="accessibility-option">
                    <label>Font Size:</label>
                    <div class="font-size-controls">
                        <button class="font-btn" id="normalFont">A</button>
                        <button class="font-btn" id="largeFont">A+</button>
                    </div>
                </div>
                <div class="accessibility-option">
                    <label for="highContrast">High Contrast:</label>
                    <input type="checkbox" id="highContrast">
                </div>
            </div>
        </div>

        <div class="chat-container">
            <div class="sidebar">
                <button class="main-button" id="learnBasics">
                    <i>🎓</i> Learn Basics
                </button>
                <button class="main-button" id="askQuestion">
                    <i>❓</i> Ask a Question
                </button>
                <button class="main-button" id="getHelp">
                    <i>🛠️</i> Get Help
                </button>
                <button class="main-button" id="quickTips">
                    <i>💡</i> Quick Tips
                </button>
                <button class="main-button" id="aboutButton">
                    <i>ℹ️</i> About DigiBuddy
                </button>
            </div>

            <div class="chat-box">
                <div class="chat-header">
                    <div class="bot-info">
                        <div class="bot-avatar">D</div>
                        <div class="bot-name">DigiBuddy</div>
                    </div>
                    <div class="chat-accessibility">
                        <button class="accessibility-btn" id="accessibilityBtn" title="Accessibility Options">
                            👁️
                        </button>
                    </div>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <!-- Messages will be added here dynamically -->
                </div>

                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="userInput" placeholder="Type your message here...">
                    <button class="voice-btn" id="voiceBtn" title="Voice Input">
                        🎤
                    </button>
                    <button class="send-btn" id="sendBtn" title="Send Message">
                        ➤
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Documentation Modal -->
    <div id="docsModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" id="closeModal">×</button>
            <h2 class="modal-title">About DigiBuddy Chatbot</h2>
            <div class="chatbot-docs">
                <h3>Features</h3>
                <ul>
                    <li><span class="feature-icon">🎓</span><strong>Learn Basics:</strong> Interactive tutorials on digital fundamentals</li>
                    <li><span class="feature-icon">❓</span><strong>Ask Questions:</strong> Get simple answers to tech questions</li>
                    <li><span class="feature-icon">🛠️</span><strong>Get Help:</strong> Step-by-step troubleshooting assistance</li>
                    <li><span class="feature-icon">💡</span><strong>Quick Tips:</strong> Easy-to-follow digital tips for daily use</li>
                </ul>

                <h3>Accessibility Features</h3>
                <ul>
                    <li><strong>Multi-language Support:</strong> Choose from 5 different languages</li>
                    <li><strong>Font Size Adjustment:</strong> Increase text size for better readability</li>
                    <li><strong>High Contrast Mode:</strong> Enhanced visual clarity</li>
                    <li><strong>Voice Input:</strong> Speak instead of typing</li>
                </ul>

                <h3>Tools Used</h3>
                <p>This prototype demonstrates capabilities similar to what could be built with:</p>
                <ul>
                    <li>Dialogflow (Google): For conversation flows and natural language processing</li>
                    <li>ChatGPT API (OpenAI Nath): For dynamic and context-aware responses</li>
                    <li>Botpress: For the user interface components</li>
                    <li>Voiceflow: For voice interaction capabilities</li>
                </ul>

                <p>This demonstration is built with HTML, CSS, and JavaScript to showcase the potential functionality.</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const chatMessages = document.getElementById('chatMessages');
            const userInput = document.getElementById('userInput');
            const sendBtn = document.getElementById('sendBtn');
            const voiceBtn = document.getElementById('voiceBtn');
            const learnBasicsBtn = document.getElementById('learnBasics');
            const askQuestionBtn = document.getElementById('askQuestion');
            const getHelpBtn = document.getElementById('getHelp');
            const quickTipsBtn = document.getElementById('quickTips');
            const aboutButton = document.getElementById('aboutButton');
            const accessibilityBtn = document.getElementById('accessibilityBtn');
            const accessibilityPanel = document.getElementById('accessibilityPanel');
            const normalFontBtn = document.getElementById('normalFont');
            const largeFontBtn = document.getElementById('largeFont');
            const highContrastCheckbox = document.getElementById('highContrast');
            const languageSelector = document.getElementById('language');
            const docsModal = document.getElementById('docsModal');
            const closeModal = document.getElementById('closeModal');

            // Knowledge Base
            const knowledgeBase = {
                'what is a browser': "A browser is a software application that helps you access websites on the internet. Think of it like a car that takes you to different places on the internet highway! Popular browsers include Google Chrome, Safari, Firefox, and Microsoft Edge.",
                'how to set up an email account': "Setting up an email account is easy! First, choose an email service like Gmail, Outlook, or Yahoo. Then, go to their website, click on 'Create Account' or 'Sign Up', and follow the step-by-step instructions. You'll need to provide some basic information and create a username and password.",
                'how to pay bills online': "tutorial:payBills",
                'how to use whatsapp': "tutorial:whatsapp",
                'wifi not connecting': "If your Wi-Fi isn't connecting, don't worry! Let's try these simple fixes: 1) Turn your Wi-Fi off and on again on your device. 2) Restart your router by unplugging it for 30 seconds, then plugging it back in. 3) Make sure you're entering the correct Wi-Fi password. 4) Move closer to your router as walls and distance can affect the signal. Is this helping?"
            };

            // Tutorials
            const tutorials = {
                'payBills': {
                    title: "How to Pay Bills Online",
                    steps: [
                        "Choose your bank's website or a bill payment app and log in with your username and password.",
                        "Look for options like 'Bill Pay', 'Payments', or 'Transfer Money'.",
                        "Select the company you want to pay (or add a new payee if it's your first time paying them).",
                        "Enter the amount you want to pay and the date you want the payment to be sent.",
                        "Review all details carefully, then confirm your payment.",
                        "Save or print the confirmation for your records."
                    ],
                    tips: "Always make sure you're on the official website (check for 'https://' and a lock icon). Never share your password with anyone, even if they claim to be from tech support!"
                },
                'whatsapp': {
                    title: "How to Use WhatsApp",
                    steps: [
                        "Download WhatsApp from your device's app store (Google Play Store or Apple App Store).",
                        "Open the app and verify your phone number by entering the code sent to you via SMS.",
                        "Set up your profile by adding your name and an optional profile picture.",
                        "To start a chat, tap on the chat icon (usually at the bottom of the screen) and select a contact.",
                        "Type your message in the text field at the bottom and press the send button (arrow icon).",
                        "To send photos or videos, tap the attachment icon (paperclip or '+' sign) and select what you want to send."
                    ],
                    tips: "WhatsApp uses your internet connection, not SMS credits. Make sure you're connected to Wi-Fi or have mobile data enabled. You can also make voice and video calls through WhatsApp!"
                }
            };

            // Quick replies based on context
            const contextReplies = {
                'default': ["What is a browser?", "How to set up email?", "Wi-Fi not working"],
                'browser': ["How to bookmark a website?", "How to clear browsing history?", "What is private browsing?"],
                'email': ["How to attach a file to email?", "How to create email folders?", "How to recognize spam emails?"],
                'wifi': ["How to find Wi-Fi password?", "How to connect new device to Wi-Fi?", "What is a strong Wi-Fi signal?"],
                'whatsapp': ["How to make WhatsApp call?", "How to create WhatsApp group?", "How to send photos on WhatsApp?"],
                'bills': ["Is online banking safe?", "How to set up automatic payments?", "How to check transaction history?"]
            };

            // Quick tips for parents and elderly
            const quickTips = [
                "When creating passwords, try using a phrase you'll remember plus numbers, like 'GardeningIsFun2024!'",
                "Always look for the padlock symbol in your browser when entering personal information online.",
                "To avoid eye strain, follow the 20-20-20 rule: Every 20 minutes, look at something 20 feet away for 20 seconds.",
                "Double-check email sender addresses before clicking any links to avoid phishing attempts.",
                "You can make text larger on most devices: On smartphones, look for 'Display' or 'Accessibility' in settings.",
                "If a website looks suspicious or asks for unnecessary information, trust your instincts and close it.",
                "Take screenshots of important information by pressing the Power and Volume Down buttons together on most smartphones.",
                "Use cloud services like Google Drive or Dropbox to keep important documents safe and accessible from any device."
            ];

            // Motivation messages
            const motivationMessages = [
                "You're doing amazing! Learning new technology is like learning to ride a bike - practice makes perfect!",
                "Remember, everyone was a beginner once. You're making great progress!",
                "Age is just a number when it comes to learning digital skills. You've got this!",
                "The digital world is lucky to have you joining it. Keep up the wonderful progress!",
                "Learning something new each day keeps the mind young and active. You're on the right track!",
                "Don't worry about making mistakes - that's how we all learn best!",
                "Your determination to learn new skills is truly inspiring!",
                "Technology is just a tool - and you're becoming a skilled craftsperson!"
            ];

            // Current context for suggestions
            let currentContext = 'default';
            
            // Bot personality phrases
            const botGreetings = [
                "Hello! I'm DigiBuddy, your tech-savvy buddy. Let's master the digital world together!",
                "Hi there! DigiBuddy at your service. No question is too simple - I'm here to help!",
                "Welcome! I'm DigiBuddy, ready to make technology friendly and fun for you!"
            ];
            
            const botThinking = [
                "Let me think about that for a moment...",
                "Hmm, looking that up for you...",
                "Processing your question... One moment please!"
            ];

            const botConfused = [
                "I'm not quite sure I understood that. Could you phrase it differently?",
                "That's a bit tricky for me. Could you try asking in a different way?",
                "I want to help, but I'm not sure what you're asking. Can you be more specific?"
            ];

            // Initialize chat with greeting
            function initChat() {
                const randomGreeting = botGreetings[Math.floor(Math.random() * botGreetings.length)];
                addBotMessage(randomGreeting);
                
                // Add quick reply suggestions
                addQuickReplies(contextReplies.default);
                
                // Add motivation message
                setTimeout(() => {
                    const randomMotivation = motivationMessages[Math.floor(Math.random() * motivationMessages.length)];
                    addMotivationMessage(randomMotivation);
                }, 2000);
            }

            // Add a bot message to the chat
            function addBotMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message bot-message';
                messageDiv.textContent = message;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Add a tutorial message to the chat
            function addTutorialMessage(tutorial) {
                const tutorialData = tutorials[tutorial];
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message tutorial-message';
                
                let stepsHTML = '';
                tutorialData.steps.forEach((step, index) => {
                    stepsHTML += `<li>${step}</li>`;
                });
                
                messageDiv.innerHTML = `
                    <h3>${tutorialData.title}</h3>
                    <ol>${stepsHTML}</ol>
                    <div class="tutorial-tips">${tutorialData.tips}</div>
                `;
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Update context for suggestions
                currentContext = tutorial === 'payBills' ? 'bills' : 'whatsapp';
                addQuickReplies(contextReplies[currentContext]);
            }

            // Add a user message to the chat
            function addUserMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message user-message';
                messageDiv.textContent = message;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Add motivation message
            function addMotivationMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'motivation-banner';
                messageDiv.textContent = message;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Add quick reply buttons
            function addQuickReplies(replies) {
                const quickRepliesDiv = document.createElement('div');
                quickRepliesDiv.className = 'quick-replies';
                
                replies.forEach(reply => {
                    const button = document.createElement('button');
                    button.className = 'quick-reply-btn';
                    button.textContent = reply;
                    button.addEventListener('click', () => {
                        handleUserInput(reply);
                    });
                    quickRepliesDiv.appendChild(button);
                });
                
                chatMessages.appendChild(quickRepliesDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Show typing indicator
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.id = 'typingIndicator';
                
                for (let i = 0; i < 3; i++) {
                    const dot = document.createElement('div');
                    dot.className = 'typing-dot';
                    typingDiv.appendChild(dot);
                }
                
                chatMessages.appendChild(typingDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Hide typing indicator
            function hideTypingIndicator() {
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }

            // Process user input and generate response
            function handleUserInput(input) {
                if (!input.trim()) return;
                
                addUserMessage(input);
                userInput.value = '';
                
                showTypingIndicator();
                
                // Simulate thinking time for more natural conversation
                setTimeout(() => {
                    hideTypingIndicator();
                    
                    // Convert input to lowercase for easier matching
                    const lowerInput = input.toLowerCase();
                    
                    // Find matching response by checking if the input contains any of the knowledge base keys
                    let response = null;
                    
                    for (const key in knowledgeBase) {
                        if (lowerInput.includes(key)) {
                            response = knowledgeBase[key];
                            
                            // Set context based on matched keyword
                            if (key.includes('browser')) currentContext = 'browser';
                            else if (key.includes('email')) currentContext = 'email';
                            else if (key.includes('wifi')) currentContext = 'wifi';
                            else if (key.includes('whatsapp')) currentContext = 'whatsapp';
                            else if (key.includes('bill')) currentContext = 'bills';
                            
                            break;
                        }
                    }
                    
                    // Check for tutorial responses
                    if (response && response.startsWith('tutorial:')) {
                        const tutorialId = response.split(':')[1];
                        addTutorialMessage(tutorialId);
                    } 
                    // Regular text response
                    else if (response) {
                        addBotMessage(response);
                        // Add contextual quick replies
                        addQuickReplies(contextReplies[currentContext]);
                    } 
                    // Handle "Learn Basics" topic
                    else if (lowerInput.includes('learn basics') || lowerInput === 'basics') {
                        addBotMessage("I'd be happy to help you learn the basics of technology! What would you like to learn about today? Here are some popular topics:");
                        addQuickReplies(["Internet Basics", "Email Basics", "Smartphone Basics", "Online Safety"]);
                    }
                    // Handle quick tips request
                    else if (lowerInput.includes('quick tip') || lowerInput.includes('tip')) {
                        const randomTip = quickTips[Math.floor(Math.random() * quickTips.length)];
                        addBotMessage("Here's a helpful tech tip for you:");
                        addBotMessage(randomTip);
                        
                        // Add another random tip option
                        addQuickReplies(["Another tip please!", "How to stay safe online", "Back to basics"]);
                    }
                    // Handle help request
                    else if (lowerInput.includes('help') || lowerInput.includes('troubleshoot')) {
                        addBotMessage("I'm here to help! What are you having trouble with? Common issues include:");
                        addQuickReplies(["Wi-Fi not connecting", "Email problems", "Password help", "Phone issues"]);
                    }
                    // Default response for unrecognized inputs
                    else {
                        const randomConfused = botConfused[Math.floor(Math.random() * botConfused.length)];
                        addBotMessage(randomConfused);
                        
                        // Show some helpful suggestions
                        addBotMessage("Here are some topics I can help you with:");
                        addQuickReplies(contextReplies.default);
                    }
                    
                    // Occasionally add motivational messages (20% chance)
                    if (Math.random() < 0.2) {
                        setTimeout(() => {
                            const randomMotivation = motivationMessages[Math.floor(Math.random() * motivationMessages.length)];
                            addMotivationMessage(randomMotivation);
                        }, 1000);
                    }
                }, 1500); // Simulated response time
            }

            // Event Listeners
            sendBtn.addEventListener('click', () => {
                handleUserInput(userInput.value);
            });
            
            userInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleUserInput(userInput.value);
                }
            });
            
            // Voice input simulation
            voiceBtn.addEventListener('click', () => {
                voiceBtn.textContent = '🔴'; // Recording indicator
                addBotMessage("I'm listening... (Voice recognition simulation)");
                
                setTimeout(() => {
                    voiceBtn.textContent = '🎤'; // Reset button
                    const simulatedVoiceInputs = [
                        "How do I set up an email account?",
                        "My Wi-Fi is not connecting",
                        "How do I use WhatsApp?"
                    ];
                    const randomInput = simulatedVoiceInputs[Math.floor(Math.random() * simulatedVoiceInputs.length)];
                    userInput.value = randomInput;
                    handleUserInput(randomInput);
                }, 2000);
            });
            
            // Main navigation buttons
            learnBasicsBtn.addEventListener('click', () => {
                handleUserInput("Learn Basics");
            });
            
            askQuestionBtn.addEventListener('click', () => {
                addBotMessage("What would you like to know? You can ask me about:");
                addQuickReplies(["Browser basics", "Email setup", "Wi-Fi help", "Social media"]);
            });
            
            getHelpBtn.addEventListener('click', () => {
                handleUserInput("I need help");
            });
            
            quickTipsBtn.addEventListener('click', () => {
                handleUserInput("Give me a quick tip");
            });
            
            // About button shows modal
            aboutButton.addEventListener('click', () => {
                docsModal.style.display = 'flex';
            });
            
            closeModal.addEventListener('click', () => {
                docsModal.style.display = 'none';
            });
            
            // Accessibility features
            accessibilityBtn.addEventListener('click', () => {
                accessibilityPanel.classList.toggle('hidden');
                if (!accessibilityPanel.classList.contains('hidden')) {
                    accessibilityPanel.style.opacity = '1';
                } else {
                    accessibilityPanel.style.opacity = '0';
                }
            });
            
            normalFontBtn.addEventListener('click', () => {
                document.body.classList.remove('large-font');
            });
            
            largeFontBtn.addEventListener('click', () => {
                document.body.classList.add('large-font');
            });
            
            highContrastCheckbox.addEventListener('change', () => {
                if (highContrastCheckbox.checked) {
                    document.body.classList.add('high-contrast');
                } else {
                    document.body.classList.remove('high-contrast');
                }
            });
            
            languageSelector.addEventListener('change', () => {
                const language = languageSelector.value;
                addBotMessage(`Language set to ${languageSelector.options[languageSelector.selectedIndex].text}! (Simulation - full translation would be implemented in production)`);
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === docsModal) {
                    docsModal.style.display = 'none';
                }
            });
            
            // Initialize the chat when page loads
            initChat();
        });
    </script>
</body>
</html>